<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>葡萄藤PPT</title>
    <link rel="stylesheet" href="./css/reveal/reveal.css">
    <!-- PPT主题，可以在/css/reveal/theme/中选择其他主题，目前暂时只能使用该模板 -->
    <link rel="stylesheet" href="./css/reveal/theme/ptt.css">
    <!-- syntax highlighting 代码高亮主题 -->
    <link rel="stylesheet" href="./lib/reveal/css/zenburn.css">
    <!-- 打印和PDF输出样式 -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? './css/reveal/print/pdf.css' : './css/reveal/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>
<body>
<img src="./img/demo/logo.png" alt="" usemap="#pttmap" class="base-logo">
<map name="pttmap">
    <area shape="rect" coords="0,0,276,58" href="http://www.jnshu.com" alt="" target="_blank"/>
</map>
<div class="reveal">
    <div class="slides">
        <section>
            <h2>Sping AOP
            <p></p>
            <p></p>
            <h3>java 小课堂</h3>
            <p></p>
            <p></p>
            <p>分享人：黄伟彬</p>
        </section>
        <section>
            <p>1.背景介绍</p>
            <p>2.知识剖析</p>
            <p>3.常见问题</p>
            <p>4.解决方案</p>
            <p>5.编码实战</p>
            <p>6.扩展思考</p>
            <p>7.参考文献</p>
            <p>8.更多讨论</p>
        </section>
        <section>
            <h3>1.背景介绍</h3>
        </section>
        <section>
        	<h4>什么是aop：</h4>
        	<p>通过前面的学习，我们知道 Spring 的两大核心是 IOC 和 AOP。
			这里我们说得 AOP (全称是Aspect Oriented Programming)，翻译成中文是面向切面编程。
			它的主要思想是在程序正常执行的某一个点切进去加入特定的逻辑。Spring AOP 在程序中，
			可以对业务逻辑的各个部分进行隔离，提高隔离的可重用性，从而降低耦合度。<br>
        	</p>
        </section>


        <section>
            <h3>2.知识剖析</h3>
	    <br>
        </section>


	   <section>
            <p>1.Spring中的AOP</p>
            <p>2.AOP的核心概念</p>
        </section>


        <section>
            <p>1.Spring 中的AOP</p>
            <p>个人对AOP思想的理解：<br>
			AOP 的核心思想是在动态地将代码切入到类的指定方法、
			指定位置上的编程思想。横向的抽取机制，规避了传统面向对象中纵向继承体系的重复性高耦合代码。<br>
			<br>
            其中，我们把分布于应用中多处的功能称为横切关注点，通常这些横切关注点在概念上是与应用的业务逻辑相分离的，
		    但其代码往往直接嵌入在应用的业务逻辑之中。将这些横切关注点与业务逻辑相分离正是面向切面编程（AOP）
			所要解决的。 <br>
               
            </p>
        </section>
		
		<section>
            <p>1.Spring 中的AOP</p>
            <p>AOP具体可以在下面的场景中使用:<br>
			权限、缓存、内容传递、错误处理、懒加载、调试、日志管理、性能优化、持久化、资源池、同步、事务<br> 
            </p>
        </section>
		
        <section>
            <p>2.AOP的核心概念</p>
            <p> 1、横切关注点<br>
               对哪些方法进行拦截，拦截后怎么处理，这些关注点称之为横切关注点<br>
			   <br>
			   2、切面（aspect）<br>
			   切面是通知和切入点的结合。通知说明了扩展的功能是什么和什么时候扩展，而切入点说明了在哪里进扩展
			   （指定到底是哪个方法），这就是一个完整的切面定义。可以看出切面就是表述的一个过程，
			   就是将增强应用到具体方法上的过程。<br>
            </p>
        </section>
		
		<section>
            <p>2.AOP的核心概念</p>
            <p>
			   3、连接点（joinpoint）<br>
			   能够应用通知的点 ，是在应用执行过程中能够插入切面的一个点。在spring中，这些点指的是方法，
			   spring只支持方法级别的连接点，一个类里有多少方法就有多少Jointpoint。<br>
            </p>
				4、切入点（pointcut）<br>
				指的是我们要对哪个连接点进行拦截的定义。<br>
        </section>

		<section>
            <p>2.AOP的核心概念</p>
            <p>
			   5、通知（advice）<br>
			  也称为增强。指的是拦截到Joinpoint后你想要扩展的功能，也就是上面说的 安全，事物，日志等。有五种类型的通知：<br>
			  有五种类型的通知：<br>
			  Before（前置）：在方法被调用之前调用通知；<br>
			  After（后置）：在方法调用之后调用通知；（不管该方法是否执行成功）<br>
			  After-returning（返回结果通知）：在方法返回结果后；<br>
			  After-throwing（异常通知）：在方法抛出异常后；<br>
			  Around（环绕）：在方法调用之前和之后都会调用通知；<br>
			  指的是我们要对哪个连接点进行拦截的定义。<br>
        </section>
		
		<section>
            <p>2.AOP的核心概念</p>
			   6、目标（target）<br>
			  代理的目标对象（要增强的类）<br>
			  <br>
			  7、织入（weave）<br>
			  是把增强应用到目标的过程。<br>
			  <br>
			  8、引入（introduction）<br>
			 引入允许我们向现有的类添加新方法或属性，从而可以在无需修改现有类的情况下，让它们具有新的行为和状态。<br>
        </section>


        <section>
            <h3>3.常见问题</h3>
			3.1.AOP 切割的两种方式<br>
			3.2.AOP 切入点的定位是如何完成的？<br>
			3.3Spring AOP无法拦截Controller中的方法?
        </section>
  
    
        <section>
            <h3>4.解决方案</h3>
			4.1.AOP 切割的两种方式：<br>
			基于 xml 和基于注解的配置方式<br>
        </section>
		
		<section>
            <h3>4.解决方案</h3>
			4.2.AOP 切入点的定位是如何完成的？<br>
			使用表达式来配置切入点，表达式有很多种，但是绝大多数问题都可以用execution表达式来解决。<br>
			1.execution（* com.ptteng.controller.controller.listCategory(..))<br>
			2.execution（* ccom.ptteng.controller.controller.*(..))<br>
			3.execution（* *.*(..))<br>
			4.匹配所有save开头的方法：execution(* save*(..))<br>
        </section>

		<section>
            <h3>4.解决方案</h3>
			4.3.Spring AOP无法拦截Controller中的方法<br>
			因为Spring的Bean扫描和Spring-MVC的Bean扫描是分开的, 两者的Bean位于两个不同的Application,
			而且Spring-MVC的Bean扫描要早于Spring的Bean扫描, 所以当Controller Bean生成完成后, 
			再执行Spring的Bean扫描,Spring会发现要被AOP代理的Controller Bean已经在容器中存在, 配置AOP就无效了<br>
        </section>

		<section>
            <h3>4.解决方案</h3>
			同样这样的情况也存在于数据库事务中, 如果Service的Bean扫描配置在spring-mvc.xml中,
			而数据库事务管理器配置在application.xml中, 会导致数据库事务失效, 原理一样.所以这里,
			我们需要把AOP放置在Controller扫描配置的文件中.<br>
			Spring的配置文件application.xml包含了 开启AOP自动代理,Service扫描配置, 现在只包含了service的自动扫描配置.
        </section>		
      
        <section>
            <h3>5.编码实战</h3>
        </section>

        <section>
            <h3>6.扩展思考</h3>
			基于注解与基于配置文件的优缺点：<br>
			1、注解可以充分利用Java的反射机制获取类结构信息，这些信息可以有效减少配置的工作，注释和Java代码位于一个文件中，
			而XML 配置采用独立的配置文件，大多数配置信息在程序开发完成后都不会调整，如果配置信息和 Java 代码放在一起，
			有助于增强程序的内聚性。而采用独立的 XML 配置文件，程序员在编写一个功能时，往往需要在程序文件和配置文件中不停切换，
			种思维上的不连贯会降低开发效率.<br>
			<br>
			2、个人认为如果开发的程序比较复杂的话还是多用xml配置，这样以后方便维护，反之则使用注解.<br>
        </section>
 
        <section>
            <h3>7.参考文献</h3>
			 https://blog.csdn.net/loongshawn/article/details/72303040<br>
			 https://my.oschina.net/GinkGo/blog/1577574<br>
			 https://blog.csdn.net/yujin753/article/details/46688105<br>

        </section>
        <section>
           <p>百度、维基、CSDN</p>
        </section>
        <section>
            <h3>8.更多讨论</h3>
			1.spring aop 拦截controller怎么传递request<br>
			在到达controller之前拦截，有两种方法，一种AOP和一种Filter。都可以在到达Controller之前拦截。<br>
			
			
			
        </section>
		   <section>
            <h3>8.更多讨论</h3>
			2.Spring AOP 实现方式<br>
			Spring有两种实现AOP的方式：Java动态代理 和 Cglib. 默认使用动态代理，当目标对象没有实现接口时，
			就会使用后者. 我们这里使用Java的动态代理实现一个简单的AOP, 可以更深刻的理解Spring AOP<br>
        </section>
		
			
        </section>
		   <section>
            <h3>8.更多讨论</h3>
			3.怎么开启JDK代理或CGLib代理？<br>
			在Spring配置文件的切面驱动中加入proxy-target-class="true"字段，"true"表示开启CGLib代理，
			"false"表示开启JDK代理，若不加入这一字段，则默认启用JDK代理<br>
        </section>


        <section>
            <h4>鸣谢</h4>
            <p>感谢观看,如有出错,恳请指正。</p>
            <p>
               BY : 深圳分院 黄伟彬
            </p>
        </section>
    </div>
</div>
<script src="./lib/reveal/js/head.min.js"></script>
<script src="./lib/reveal/reveal.js"></script>
<script>
    // 初始化幻灯片
    Reveal.initialize({
        history: true,
        dependencies: [
            {src: './plugin/markdown/marked.js'},
            {src: './plugin/markdown/markdown.js'},
            {src: './plugin/notes/notes.js', async: true},
            {
                src: './plugin/highlight/highlight.js', async: true, callback: function () {
                hljs.initHighlightingOnLoad();
            }
            }
        ]
    });
</script>
</body>
</html>

